CREATE TABLE ficha_tecnica (
    ficha_id         INTEGER NOT NULL,
    sku              VARCHAR2(50) NOT NULL,
    nombre           VARCHAR2(100) NOT NULL,
    descripcion      CLOB,
    precio_unitario  NUMBER NOT NULL
);

ALTER TABLE ficha_tecnica ADD CONSTRAINT ficha_tecnica_pk PRIMARY KEY ( ficha_id );

CREATE TABLE producto (
    id                      INTEGER NOT NULL,
    producto_id             INTEGER NOT NULL,
    ficha_id                INTEGER NOT NULL,
    codigo_barras           VARCHAR2(100),
    fecha_ingreso           DATE NOT NULL,
    ficha_tecnica_ficha_id  INTEGER NOT NULL
);

ALTER TABLE producto ADD CONSTRAINT producto_pk PRIMARY KEY ( id );

CREATE TABLE transaccion (
    trans_id         INTEGER NOT NULL,
    producto_id      INTEGER NOT NULL,
    fecha_trans      DATE NOT NULL,
    tipo             VARCHAR2(50) NOT NULL,
    cantidad         INTEGER NOT NULL,
    precio_unitario  NUMBER NOT NULL,
    usuario          VARCHAR2(50) NOT NULL,
    producto_id2     INTEGER NOT NULL
);

ALTER TABLE transaccion ADD CONSTRAINT transaccion_pk PRIMARY KEY ( trans_id,
                                                                    producto_id2 );

ALTER TABLE producto
    ADD CONSTRAINT producto_ficha_tecnica_fk FOREIGN KEY ( ficha_tecnica_ficha_id )
        REFERENCES ficha_tecnica ( ficha_id );

ALTER TABLE transaccion
    ADD CONSTRAINT transaccion_producto_fk FOREIGN KEY ( producto_id2 )
        REFERENCES producto ( id );
